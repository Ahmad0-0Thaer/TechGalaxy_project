<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roadmap Creator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: auto;
        }
        .box {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input, select, textarea, button {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            background-color: #6200ea;
            color: white;
            border: none;
            cursor: pointer;
        }
        .field {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            background: #fafafa;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Roadmap Creation Box -->
        <div class="box">
            <h2>Create Roadmap</h2>
            <label>Roadmap Title</label>
            <input type="text" id="roadmapTitle">
            <label>Description</label>
            <textarea id="roadmapDescription"></textarea>
            <label>Difficulty Level</label>
            <select id="difficulty">
                <option>Beginner</option>
                <option>Intermediate</option>
                <option>Advanced</option>
            </select>
            <label>Category</label>
            <select id="category">
                <option>Web Development</option>
                <option>Mobile Development</option>
                <option>Data Science</option>
                <option>UX/UI Design</option>
                <option>DevOps</option>
                <option>AI & Machine Learning</option>
                <option>Cybersecurity</option>
                <option>Game Development</option>
                <option>Cloud Computing</option>
                <option>Other</option>
            </select>
            <label>Tag</label>
            <input type="text" id="tag">
            <label>Cover Image</label>
            <input type="file" id="coverImage">
            <button onclick="createRoadmap()">Create Roadmap</button>
        </div>

        <!-- Fields Creation Box -->
        <div class="box">
            <h2>Add Field</h2>
            <label>Field Title</label>
            <input type="text" id="fieldTitle">
            <label>Field Description</label>
            <textarea id="fieldDescription"></textarea>
            <label>Resource Link</label>
            <input type="text" id="resourceLink">
            <button onclick="addField()">Add Field</button>
            <div id="fieldsContainer"></div>
        </div>
    </div>

    <script>
        let roadmapId = null;
        async function createRoadmap() {
            const formData = new FormData();
            formData.append("Title", document.getElementById("roadmapTitle").value);
            formData.append("Description", document.getElementById("roadmapDescription").value);
            formData.append("DifficultyLevel", document.getElementById("difficulty").value);
            formData.append("Category", document.getElementById("category").value);
            formData.append("Tag", document.getElementById("tag").value);
            formData.append("CoverImage", document.getElementById("coverImage").files[0]);
            formData.append("StepTitle", "");
            formData.append("StepDescription", "");

            const res = await fetch('https://techgalaxy-ejdjesbvb4d6h9dd.israelcentral-01.azurewebsites.net/api/Roadmaps/create-or-update', {
                method: 'POST',
                body: formData
            });
            const data = await res.json();
            roadmapId = data.id;
            alert("Roadmap created with ID: " + roadmapId);
        }

        async function addField() {
            if (!roadmapId) {
                alert("Please create a roadmap first.");
                return;
            }
            const title = document.getElementById("fieldTitle").value;
            const description = document.getElementById("fieldDescription").value;
            const link = document.getElementById("resourceLink").value;

            const fieldRes = await fetch(`https://techgalaxy-ejdjesbvb4d6h9dd.israelcentral-01.azurewebsites.net/api/Fields/${roadmapId}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ title, description })
            });
            const fieldData = await fieldRes.json();

            await fetch('https://techgalaxy-ejdjesbvb4d6h9dd.israelcentral-01.azurewebsites.net/api/Fields/add-resource', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ fieldId: fieldData.id, link })
            });

            const fieldBox = document.createElement("div");
            fieldBox.className = "field";
            fieldBox.innerHTML = `<strong>${title}</strong><p>${description}</p><a href="${link}" target="_blank">${link}</a>`;
            document.getElementById("fieldsContainer").appendChild(fieldBox);
        }
    </script>
</body>
</html>
