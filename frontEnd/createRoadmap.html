<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechGalaxy Roadmap Creator</title>
    <style>
        /*-----------------------------------*\
          #CUSTOM PROPERTY
        \*-----------------------------------*/

        :root {
          /**
           * COLORS
           */

          /* background color */
          --bg-purple: hsla(267, 100%, 63%, 1);
          --bg-purple-alpha-30: hsla(267, 100%, 63%, 0.3);
          --bg-dark-purple: hsla(279, 42%, 9%, 1);
          --bg-oxford-blue: hsla(240, 63%, 13%, 1);
          --bg-oxford-blue-alpha-95: hsla(240, 63%, 13%, 0.95);
          --bg-oxford-blue-alpha-90: hsla(240, 63%, 13%, 0.9);
          --bg-oxford-blue-alpha-80: hsla(240, 63%, 13%, 0.8);

          /* gradient color */
          --gradient-1: linear-gradient(to right bottom, hsl(299, 100%, 52%), hsl(291, 100%, 58%), hsl(283, 100%, 60%), hsl(273, 100%, 62%), hsl(262, 100%, 63%), hsl(242, 100%, 69%), hsl(223, 100%, 62%), hsl(210, 100%, 50%), hsl(203, 100%, 50%), hsl(198, 100%, 50%), hsl(192, 100%, 48%), hsl(185, 90%, 48%));
          --gradient-2: linear-gradient(90deg, transparent 0%, #9841ff 50%, transparent 100%);

          /* text color */
          --text-white: hsla(0, 0%, 100%, 1);
          --text-gainsboro: hsla(0, 0%, 87%, 1);
          --text-champagne-pink: hsla(23, 61%, 86%, 1);
          --text-purple: hsla(267, 100%, 63%, 1);

          /* border color */
          --border-space-cadet: hsl(240, 45%, 17%);
          --border-purple-alpha-30: hsla(267, 100%, 63%, 0.3);

          /**
           * TYPOGRAPHY
           */

          /* font family */
          --fontFamily-oxanium: 'Oxanium', cursive;
          --fontFamily-work-sans: 'Work Sans', sans-serif;

          /* font size */
          --fontSize-1: 3.6rem;
          --fontSize-2: 2.4rem;
          --fontSize-3: 2rem;
          --fontSize-4: 1.7rem;
          --fontSize-5: 1.6rem;
          --fontSize-6: 1.5rem;
          --fontSize-7: 1.4rem;
          --fontSize-8: 1.2rem;

          /* font weight */
          --weight-regular: 400;
          --weight-semiBold: 600;
          --weight-bold: 700;

          /**
           * SPACING
           */

          --section-spacing: 60px;

          /**
           * BOX SHADOW
           */

          --shadow: 0px 2px 5px 0px hsla(0, 0%, 0%, 0.2);

          /**
           * BORDER RADIUS
           */

          --radius-circle: 50%;
          --radius-5: 5px;
          --radius-3: 3px;

          /**
           * CLIP PATH
           */

          --clip-path-1: polygon(0 0, 100% 0, 100% 0, 0 0);
          --clip-path-2: polygon(0 0, 100% 0, 100% 100%, 0 100%);
          --clip-path-3: polygon(0% 0%, 90% 0, 100% 30%, 100% 100%, 0 100%);
          --clip-path-4: polygon(90% 0, 100% 40%, 100% 100%, 0 100%, 0 0);
          --clip-path-5: polygon(100% 0, 100% 100%, 10% 100%, 0 60%, 0 0);
          --clip-path-6: polygon(10% 0, 100% 0, 100% 100%, 0 100%, 0 40%);
          --clip-path-7: polygon(100% 0, 100% 60%, 90% 100%, 0 100%, 0 0);
          --clip-path-8: polygon(0% 0%, 70% 0, 100% 30%, 100% 100%, 0 100%);
          --clip-path-9: polygon(0 0, 90% 0, 100% 100%, 0% 100%);

          /**
           * TRANSITION
           */

          --transition-1: 250ms ease;
          --transition-2: 500ms ease;
          --cubic-out: cubic-bezier(0.05, 0.83, 0.52, 0.97);
        }

        /*-----------------------------------*\
          #RESET
        \*-----------------------------------*/

        *,
        *::before,
        *::after {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        li {
          list-style: none;
        }

        a,
        img,
        time,
        span,
        input,
        button,
        textarea,
        ion-icon {
          display: block;
        }

        a {
          color: inherit;
          text-decoration: none;
        }

        img {
          height: auto;
        }

        input,
        button,
        textarea {
          background: none;
          border: none;
          font: inherit;
        }

        input,
        textarea {
          width: 100%;
        }

        button {
          cursor: pointer;
        }

        ion-icon {
          pointer-events: none;
        }

        address {
          font-style: normal;
        }

        html {
          font-size: 10px;
          scroll-behavior: smooth;
        }

        body {
          background-color: var(--bg-dark-purple);
          color: var(--text-gainsboro);
          font-family: var(--fontFamily-oxanium);
          font-size: var(--fontSize-4);
          font-weight: var(--weight-regular);
          line-height: 1.6;
          overflow-x: hidden;
        }

        ::-webkit-scrollbar {
          width: 8px;
        }

        ::-webkit-scrollbar-track {
          background-color: var(--bg-dark-purple);
        }

        ::-webkit-scrollbar-thumb {
          background-color: var(--bg-purple);
        }

        /*-----------------------------------*\
          #REUSED STYLE
        \*-----------------------------------*/

        .container {
          padding-inline: 12px;
          max-width: 1200px;
          margin: 0 auto;
        }

        .has-before,
        .has-after {
          position: relative;
          z-index: 1;
        }

        .has-before::before,
        .has-after::after {
          content: "";
          position: absolute;
        }

        .title {
          color: var(--text-white);
        }

        .h1,
        .h3 {
          line-height: 1.3;
        }

        .h1 {
          font-size: var(--fontSize-1);
          font-weight: var(--weight-semiBold);
        }

        .h2 {
          font-size: var(--fontSize-2);
          line-height: 1.4;
        }

        .h3 {
          font-size: var(--fontSize-3);
        }

        .btn {
          position: relative;
          background-image: var(--gradient-1);
          color: var(--text-white);
          font-size: var(--fontSize-6);
          font-weight: var(--weight-semiBold);
          max-width: max-content;
          min-width: 180px;
          height: 50px;
          display: grid;
          place-items: center;
          padding-inline: 30px;
          clip-path: var(--clip-path-3);
          overflow: hidden;
          margin: 10px 0;
        }

        .btn::before {
          content: "";
          position: absolute;
          top: var(--top, 50%);
          left: var(--left, 50%);
          width: 250%;
          padding-block-end: 250%;
          background-color: var(--bg-purple);
          transform: translate(-50%, -50%) scale(0);
          border-radius: var(--radius-circle);
          z-index: -1;
          transition: transform var(--transition-2);
        }

        .btn:is(:hover, :focus-visible)::before {
          transform: translate(-50%, -50%) scale(1);
        }

        .w-100 {
          width: 100%;
        }

        .section {
          padding-block: var(--section-spacing);
        }

        .section-title {
          margin-block: 10px;
          text-transform: uppercase;
        }

        .section-title .span {
          display: inline;
          color: var(--text-purple);
        }

        .section-text {
          margin-block-end: 40px;
          max-width: 480px;
          margin-inline: auto;
        }

        .social-wrapper {
          display: flex;
          align-items: center;
          gap: 10px;
        }

        .img-holder {
          background-color: var(--bg-purple);
          aspect-ratio: var(--width) / var(--height);
          overflow: hidden;
        }

        .img-cover {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        [data-reveal] {
          opacity: 0;
          transition: var(--transition-2);
        }

        [data-reveal="left"] {
          transform: translateX(-20px);
        }

        [data-reveal="right"] {
          transform: translateX(20px);
        }

        [data-reveal="bottom"] {
          transform: translateY(20px);
        }

        [data-reveal].revealed {
          opacity: 1;
          transform: translate(0);
        }

        /*-----------------------------------*\
          #ROADMAP CREATOR STYLES
        \*-----------------------------------*/

        .roadmap-creator {
          padding: 40px 0;
        }

        .creator-header {
          text-align: center;
          margin-bottom: 40px;
        }

        .creator-header h1 {
          color: var(--text-white);
          font-size: var(--fontSize-1);
          margin-bottom: 10px;
        }

        .creator-header p {
          color: var(--text-gainsboro);
          max-width: 600px;
          margin: 0 auto;
        }

        .creator-container {
          display: flex;
          gap: 30px;
          flex-wrap: wrap;
        }

        .roadmap-form, .fields-container {
          background-color: var(--bg-oxford-blue-alpha-90);
          border-radius: var(--radius-5);
          padding: 30px;
          box-shadow: var(--shadow);
          flex: 1;
          min-width: 300px;
        }

        .form-group {
          margin-bottom: 20px;
        }

        .form-group label {
          display: block;
          color: var(--text-white);
          margin-bottom: 8px;
          font-weight: var(--weight-semiBold);
        }

        .form-control {
          width: 100%;
          padding: 12px 15px;
          background-color: var(--bg-oxford-blue);
          border: 1px solid var(--border-purple-alpha-30);
          border-radius: var(--radius-5);
          color: var(--text-white);
          font-size: var(--fontSize-5);
        }

        .form-control:focus {
          outline: none;
          border-color: var(--bg-purple);
        }

        textarea.form-control {
          min-height: 100px;
          resize: vertical;
        }

        .tags-container {
          display: flex;
          flex-wrap: wrap;
          gap: 8px;
          margin-top: 10px;
        }

        .tag {
          background-color: var(--bg-purple-alpha-30);
          color: var(--text-white);
          padding: 5px 12px;
          border-radius: var(--radius-5);
          display: flex;
          align-items: center;
          gap: 5px;
          font-size: var(--fontSize-7);
        }

        .tag-remove {
          background: none;
          border: none;
          color: var(--text-white);
          cursor: pointer;
          font-size: var(--fontSize-7);
        }

        .difficulty-level {
          display: flex;
          gap: 15px;
          margin-top: 10px;
        }

        .difficulty-btn {
          flex: 1;
          padding: 10px;
          text-align: center;
          border-radius: var(--radius-5);
          background-color: var(--bg-oxford-blue);
          border: 1px solid var(--border-purple-alpha-30);
          color: var(--text-white);
          transition: var(--transition-1);
          cursor: pointer;
        }

        .difficulty-btn:hover {
          border-color: var(--bg-purple);
        }

        .difficulty-btn.active {
          background-color: var(--bg-purple);
          border-color: var(--bg-purple);
        }

        .cover-image-preview {
          width: 100%;
          height: 200px;
          background-color: var(--bg-oxford-blue);
          border-radius: var(--radius-5);
          margin-top: 10px;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .cover-image-preview img {
          max-width: 100%;
          max-height: 100%;
          object-fit: cover;
        }

        .upload-btn {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background-color: var(--bg-purple-alpha-30);
          padding: 10px 20px;
          border-radius: var(--radius-5);
          color: var(--text-white);
          cursor: pointer;
          text-align: center;
          display: none;
        }

        .cover-image-preview:hover .upload-btn {
          display: block;
        }

        .fields-list {
          margin-top: 30px;
        }

        .field-item {
          background-color: var(--bg-oxford-blue);
          border-radius: var(--radius-5);
          padding: 20px;
          margin-bottom: 20px;
          position: relative;
        }

        .field-item h3 {
          color: var(--text-white);
          margin-bottom: 10px;
        }

        .field-item p {
          color: var(--text-gainsboro);
          margin-bottom: 15px;
        }

        .resources-list {
          margin-top: 15px;
          padding-left: 20px;
        }

        .resource-item {
          display: flex;
          align-items: center;
          margin-bottom: 8px;
        }

        .resource-item a {
          color: var(--text-purple);
          margin-right: 10px;
          word-break: break-all;
        }

        .resource-item button {
          background: none;
          border: none;
          color: var(--text-white);
          cursor: pointer;
        }

        .add-resource-form {
          display: flex;
          gap: 10px;
          margin-top: 10px;
        }

        .add-resource-form input {
          flex: 1;
          padding: 8px 12px;
          background-color: var(--bg-oxford-blue);
          border: 1px solid var(--border-purple-alpha-30);
          border-radius: var(--radius-5);
          color: var(--text-white);
        }

        .add-resource-form button {
          padding: 8px 15px;
          background-color: var(--bg-purple);
          color: var(--text-white);
          border-radius: var(--radius-5);
          border: none;
        }

        .field-actions {
          position: absolute;
          top: 15px;
          right: 15px;
          display: flex;
          gap: 10px;
        }

        .field-actions button {
          background: none;
          border: none;
          color: var(--text-white);
          cursor: pointer;
          font-size: var(--fontSize-5);
        }

        .field-actions button:hover {
          color: var(--text-purple);
        }

        .add-field-btn {
          width: 100%;
          margin-top: 20px;
        }

        .preview-btn {
          margin-top: 30px;
          width: 100%;
        }

        /* Responsive styles */
        @media (max-width: 768px) {
          .creator-container {
            flex-direction: column;
          }
          
          .roadmap-form, .fields-container {
            width: 100%;
          }
        }
    </style>
</head>
<body>
    <div class="roadmap-creator">
        <div class="container">
            <div class="creator-header">
                <h1>TechGalaxy Roadmap Creator</h1>
                <p>Create your learning journey through the tech universe</p>
            </div>

            <div class="creator-container">
                <!-- Roadmap Creation Form -->
                <div class="roadmap-form">
                    <h2>Create Roadmap</h2>
                    <form id="roadmapForm">
                        <div class="form-group">
                            <label for="roadmapTitle">Roadmap Title</label>
                            <input type="text" id="roadmapTitle" class="form-control" placeholder="Enter roadmap title" required>
                        </div>

                        <div class="form-group">
                            <label for="roadmapDescription">Description</label>
                            <textarea id="roadmapDescription" class="form-control" placeholder="Enter roadmap description" required></textarea>
                        </div>

                        <div class="form-group">
                            <label>Difficulty Level</label>
                            <div class="difficulty-level">
                                <button type="button" class="difficulty-btn" data-level="Beginner">Beginner</button>
                                <button type="button" class="difficulty-btn" data-level="Intermediate">Intermediate</button>
                                <button type="button" class="difficulty-btn" data-level="Advanced">Advanced</button>
                            </div>
                            <input type="hidden" id="difficultyLevel" value="">
                        </div>

                        <div class="form-group">
                            <label>Cover Image</label>
                            <div class="cover-image-preview" id="coverImagePreview">
                                <span class="upload-btn">Upload Cover Image</span>
                                <input type="file" id="coverImage" accept="image/*" style="display: none;">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="roadmapCategory">Category</label>
                            <select id="roadmapCategory" class="form-control" required>
                                <option value="">Select a category</option>
                                <option value="Web Development">Web Development</option>
                                <option value="Mobile Development">Mobile Development</option>
                                <option value="Data Science">Data Science</option>
                                <option value="UX/UI Design">UX/UI Design</option>
                                <option value="DevOps">DevOps</option>
                                <option value="AI & Machine Learning">AI & Machine Learning</option>
                                <option value="Cybersecurity">Cybersecurity</option>
                                <option value="Game Development">Game Development</option>
                                <option value="Cloud Computing">Cloud Computing</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="roadmapTags">Tags</label>
                            <input type="text" id="roadmapTags" class="form-control" placeholder="Press Enter to add tag">
                            <div class="tags-container" id="tagsContainer"></div>
                        </div>

                        <button type="submit" class="btn">Save Roadmap</button>
                    </form>
                </div>

                <!-- Fields Creation Section -->
                <div class="fields-container">
                    <h2>Roadmap Fields</h2>
                    <div id="fieldsList" class="fields-list">
                        <!-- Fields will be added here dynamically -->
                        <p>No fields added yet. Add your first field below.</p>
                    </div>

                    <form id="addFieldForm">
                        <div class="form-group">
                            <label for="fieldTitle">Field Title</label>
                            <input type="text" id="fieldTitle" class="form-control" placeholder="Enter field title" required>
                        </div>

                        <div class="form-group">
                            <label for="fieldDescription">Field Description</label>
                            <textarea id="fieldDescription" class="form-control" placeholder="What should learners do in this field?" required></textarea>
                        </div>

                        <button type="submit" class="btn add-field-btn">Add Field</button>
                    </form>

                    <button id="previewBtn" class="btn preview-btn">Preview Roadmap</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Variables to store roadmap data
            let roadmapData = {
                tags: [],
                fields: []
            };
            let coverImageFile = null;

            // Difficulty level selection
            const difficultyBtns = document.querySelectorAll('.difficulty-btn');
            difficultyBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    difficultyBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById('difficultyLevel').value = this.dataset.level;
                });
            });

            // Cover image upload
            const coverImagePreview = document.getElementById('coverImagePreview');
            const coverImageInput = document.getElementById('coverImage');
            
            coverImagePreview.addEventListener('click', function() {
                coverImageInput.click();
            });
            
            coverImageInput.addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    coverImageFile = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        coverImagePreview.innerHTML = `<img src="${event.target.result}" alt="Cover Preview">`;
                    };
                    reader.readAsDataURL(coverImageFile);
                }
            });

            // Tags functionality
            const tagsInput = document.getElementById('roadmapTags');
            const tagsContainer = document.getElementById('tagsContainer');
            
            tagsInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const tagText = this.value.trim();
                    if (tagText && !roadmapData.tags.includes(tagText)) {
                        roadmapData.tags.push(tagText);
                        renderTags();
                        this.value = '';
                    }
                }
            });
            
            function renderTags() {
                tagsContainer.innerHTML = '';
                roadmapData.tags.forEach(tag => {
                    const tagElement = document.createElement('div');
                    tagElement.className = 'tag';
                    tagElement.innerHTML = `
                        ${tag}
                        <button class="tag-remove" data-tag="${tag}">&times;</button>
                    `;
                    tagsContainer.appendChild(tagElement);
                });
                
                // Add event listeners to remove buttons
                document.querySelectorAll('.tag-remove').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const tagToRemove = this.dataset.tag;
                        roadmapData.tags = roadmapData.tags.filter(t => t !== tagToRemove);
                        renderTags();
                    });
                });
            }

            // Add field functionality
            const addFieldForm = document.getElementById('addFieldForm');
            const fieldsList = document.getElementById('fieldsList');
            
            addFieldForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fieldTitle = document.getElementById('fieldTitle').value;
                const fieldDescription = document.getElementById('fieldDescription').value;
                
                if (fieldTitle && fieldDescription) {
                    const newField = {
                        id: Date.now(), // Temporary ID
                        title: fieldTitle,
                        description: fieldDescription,
                        resources: []
                    };
                    
                    roadmapData.fields.push(newField);
                    renderFields();
                    
                    // Reset form
                    this.reset();
                }
            });
            
            function renderFields() {
                if (roadmapData.fields.length === 0) {
                    fieldsList.innerHTML = '<p>No fields added yet. Add your first field below.</p>';
                    return;
                }
                
                fieldsList.innerHTML = '';
                roadmapData.fields.forEach(field => {
                    const fieldElement = document.createElement('div');
                    fieldElement.className = 'field-item';
                    fieldElement.dataset.id = field.id;
                    
                    fieldElement.innerHTML = `
                        <div class="field-actions">
                            <button class="edit-field" data-id="${field.id}">Edit</button>
                            <button class="delete-field" data-id="${field.id}">Delete</button>
                        </div>
                        <h3>${field.title}</h3>
                        <p>${field.description}</p>
                        
                        <div class="resources-section">
                            <h4>Resources</h4>
                            <ul class="resources-list" id="resources-${field.id}">
                                ${field.resources.map(resource => `
                                    <li class="resource-item">
                                        <a href="${resource.link}" target="_blank">${resource.link}</a>
                                        <button class="delete-resource" data-id="${field.id}" data-link="${resource.link}">Delete</button>
                                    </li>
                                `).join('')}
                            </ul>
                            
                            <form class="add-resource-form" data-field-id="${field.id}">
                                <input type="url" placeholder="Add resource URL" required>
                                <button type="submit">Add</button>
                            </form>
                        </div>
                    `;
                    
                    fieldsList.appendChild(fieldElement);
                });
                
                // Add event listeners for resource forms
                document.querySelectorAll('.add-resource-form').forEach(form => {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        const fieldId = parseInt(this.dataset.fieldId);
                        const resourceUrl = this.querySelector('input').value;
                        
                        if (resourceUrl) {
                            addResourceToField(fieldId, resourceUrl);
                            this.reset();
                        }
                    });
                });
                
                // Add event listeners for delete resource buttons
                document.querySelectorAll('.delete-resource').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const fieldId = parseInt(this.dataset.id);
                        const resourceLink = this.dataset.link;
                        deleteResourceFromField(fieldId, resourceLink);
                    });
                });
                
                // Add event listeners for edit field buttons
                document.querySelectorAll('.edit-field').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const fieldId = parseInt(this.dataset.id);
                        editField(fieldId);
                    });
                });
                
                // Add event listeners for delete field buttons
                document.querySelectorAll('.delete-field').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const fieldId = parseInt(this.dataset.id);
                        deleteField(fieldId);
                    });
                });
            }
            
            function addResourceToField(fieldId, resourceUrl) {
                const field = roadmapData.fields.find(f => f.id === fieldId);
                if (field && !field.resources.some(r => r.link === resourceUrl)) {
                    field.resources.push({ link: resourceUrl });
                    renderFields();
                }
            }
            
            function deleteResourceFromField(fieldId, resourceLink) {
                const field = roadmapData.fields.find(f => f.id === fieldId);
                if (field) {
                    field.resources = field.resources.filter(r => r.link !== resourceLink);
                    renderFields();
                }
            }
            
            function editField(fieldId) {
                const field = roadmapData.fields.find(f => f.id === fieldId);
                if (field) {
                    document.getElementById('fieldTitle').value = field.title;
                    document.getElementById('fieldDescription').value = field.description;
                    
                    // Remove the field from the array
                    roadmapData.fields = roadmapData.fields.filter(f => f.id !== fieldId);
                    
                    // Focus on the title field
                    document.getElementById('fieldTitle').focus();
                }
            }
            
            function deleteField(fieldId) {
                if (confirm('Are you sure you want to delete this field?')) {
                    roadmapData.fields = roadmapData.fields.filter(f => f.id !== fieldId);
                    renderFields();
                }
            }

            // Save roadmap functionality
            const roadmapForm = document.getElementById('roadmapForm');
            
            roadmapForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const title = document.getElementById('roadmapTitle').value;
                const description = document.getElementById('roadmapDescription').value;
                const difficulty = document.getElementById('difficultyLevel').value;
                const category = document.getElementById('roadmapCategory').value;
                
                if (!title || !description || !difficulty || !category || roadmapData.tags.length === 0) {
                    alert('Please fill all required fields and add at least one tag');
                    return;
                }
                
                // Prepare form data for API
                const formData = new FormData();
                formData.append('Title', title);
                formData.append('Description', description);
                formData.append('DifficultyLevel', difficulty);
                formData.append('Category', category);
                formData.append('StepTitle', ''); // Empty for now
                formData.append('StepDescription', ''); // Empty for now
                
                // Add tags as comma-separated string
                formData.append('Tag', roadmapData.tags.join(','));
                
                // Add cover image if available
                if (coverImageFile) {
                    formData.append('CoverImage', coverImageFile);
                }
                
                try {
                    // Call the API to create/update roadmap
                    const response = await fetch('https://techgalaxy-ejdjesbvb4d6h9dd.israelcentral-01.azurewebsites.net/api/Roadmaps/create-or-update', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to save roadmap');
                    }
                    
                    const result = await response.json();
                    alert('Roadmap saved successfully!');
                    
                    // Here you would typically get the roadmap ID from the response
                    // and use it to save the fields
                    const roadmapId = result.id || 'temp-id';
                    
                    // Save fields (this is a simplified version - in a real app you'd need to handle each field)
                    await saveFields(roadmapId);
                    
                } catch (error) {
                    console.error('Error saving roadmap:', error);
                    alert('Error saving roadmap: ' + error.message);
                }
            });
            
            async function saveFields(roadmapId) {
                // This is a simplified version - in a real app you'd need to:
                // 1. First create each field (without resources)
                // 2. Then add resources to each field
                
                for (const field of roadmapData.fields) {
                    try {
                        // First create the field (you would need an API endpoint for this)
                        // Then add resources for the field using the field ID
                        for (const resource of field.resources) {
                            const resourceData = {
                                fieldId: field.id, // This should be the real field ID from the API response
                                link: resource.link
                            };
                            
                            await fetch('https://techgalaxy-ejdjesbvb4d6h9dd.israelcentral-01.azurewebsites.net/api/Fields/add-resource', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(resourceData)
                            });
                        }
                    } catch (error) {
                        console.error('Error saving field:', field.title, error);
                    }
                }
                
                alert('Fields saved successfully!');
            }

            // Preview functionality
            const previewBtn = document.getElementById('previewBtn');
            
            previewBtn.addEventListener('click', function() {
                // In a real app, this would show a preview modal or navigate to a preview page
                alert('Preview functionality would show the roadmap with all fields here');
                console.log('Roadmap data:', roadmapData);
            });
        });
    </script>
</body>
</html>